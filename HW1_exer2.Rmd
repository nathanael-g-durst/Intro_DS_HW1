---
title: "Financial Analysis"
date: "`r format(Sys.time(), '%d %B %Y')`"
author: "Adel Ben Snoussi, Xxxxxx Xxxxxxx, Eric Brandstätter, Nathanaël G. Dürst"
output: html_document
---

```{r, echo="F", output="hide"}

#Load library

library("quantmod")
library("rlang")
library("PerformanceAnalytics")

#List of the companies analyzed

tickerList = c("AAPL", "CSCO", "INTC", "HD", "GOOG", "JPM")

#Import data

getSymbols.yahoo(
  tickerList,
  env = globalenv(),
  from = "2020-01-01",
  to = "2021-01-01",
  periodicity = "daily"
)

#Plot AAPL's closing price

plot(AAPL$AAPL.Close)

#Plot CSCO's closing price

plot(CSCO$CSCO.Close)

#Candle chart GOOG 2020 Q4

candleChart(GOOG, subset = "2020-10/2020-12")

#Candle chart JPM 2020 Q4

candleChart(JPM, subset = "2020-10/2020-12")

# -------------------- Loop to replace following section (NOT WORKING) --------------------

analyzeStock <- function(tickerName) {
  
  data <- coredata((tickerName))
  returnsStock <- na.omit(ClCl(tickerName))
  meanStock <- mean(returnsStock)
  varStock <- var(returnsStock)
  
}


for (tickerName in tickerList) {

  currentTicker <- getSymbols(tickerName, auto.assign=FALSE)

  #Variable names
  varNameRe <- paste("returns",tickerName, sep = "")
  varNameMe <- paste("mean",tickerName, sep = "")
  varNameVa <- paste("var",tickerName, sep = "")
  
  tickerStock <- na.omit(ClCl(tickerName)))
  meanStock <- 
  varStock <- 
  
  #Stock returns Close to Close (clCl) ---------------- Error, tickername not recognized as input
  assign(varNameRe, returnsStock)
  
  #Returns median ---------------- Error, varNameRe not recognized as input
  assign(varNameMe, median(varNameRe))
  
  #Returns variance ---------------- Error, varNameRe not recognized as input
  assign(varNameVa, var(varNameRe))

}

#Cleaning environment after loop end
rm(tickerName, currentTicker, varNameRe, varNameMe, varNameVa)

# -------------------- END - Loop to replace following section --------------------

# --------------------- Anyway to automate this ? Loop ? Also wrong computation

#Computations AAPL

returnsAAPL <- na.omit(ClCl(AAPL))
meanAAPL = mean(AAPL$AAPL.Close)
varAAPL = var(AAPL$AAPL.Close)

#Computations CSCO

meanCSCO = mean(CSCO$CSCO.Close)
varCSCO = var(CSCO$CSCO.Close)

#Computations INTC

meanINTC = mean(INTC$INTC.Close)
varINTC = var(INTC$INTC.Close)

#Computations HD

meanHD = mean(HD$HD.Close)
varHD = var(HD$HD.Close)

#Computations GOOG

meanGOOG = mean(GOOG$GOOG.Close)
varGOOG = var(GOOG$GOOG.Close)

#Computations JPM

meanJPM = mean(JPM$JPM.Close)
varJPM = var(JPM$JPM.Close)

# ---------------------

#Import data

getSymbols.yahoo(
  tickerList,
  env = globalenv(),
  from = "2011-01-01",
  to = "2021-01-01",
  periodicity = "daily"
)

SharpeRatio.annualized(dailyReturn(AAPL), Rf = 0.03/252, scale = 252)

SharpeRatio.annualized(dailyReturn(AAPL, subset="2011-01-01/2012-01-01"), Rf = 0.03/252, scale = 252)



```
